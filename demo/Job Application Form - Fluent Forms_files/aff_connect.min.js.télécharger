window.onload=function(){function r(r){for(var e=r+"=",t=decodeURIComponent(document.cookie).split(";"),n=0;n<t.length;n++){for(var f=t[n];" "==f.charAt(0);)f=f.substring(1);if(0==f.indexOf(e))return f.substring(e.length,f.length)}return""}function e(r,e,t){var n="";if(t){var f=new Date;f.setTime(f.getTime()+864e5*t),n="; expires="+f.toUTCString()}document.cookie=r+"="+(e||"")+n+"; path=/"}function t(r){document.cookie=r+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}function n(r){var e=r.substr(1);return null!=e&&""!=e?function r(e){for(var t={},n=e.split("&"),f=0;f<n.length;f++){var i=n[f].split("=");t[i[0]]=i[1]}return t}(e):{}}function f(){var t=n(window.location.search);if(0===Object.keys(t=function r(e){for(var t in e)e[t]||delete e[t];return e}(function r(e,t,n){var f={};if(!t)return{};if("string"==typeof t)return{[t]:e[t]};for(p in e)"object"==typeof t&&n&&e[p]==t[p]?f[p]=e[p]:"object"!=typeof t||n||e[p]!==t[p]?"function"==typeof t?t(e[p],p,e)&&(f[p]=e[p]):t.length&&t.includes(p)&&(f[p]=e[p]):f[p]=e[p];return f}(t,["utm_source","utm_medium","utm_campaign","utm_term","utm_content","ref","theme_style"]))).length)return!1;var f=r("f_aff");if(f&&"object"!=typeof(f=JSON.parse(f))&&(f=!1),f)for(var i in f)t[i]||(t[i]=f[i]);return e("f_aff",JSON.stringify(t),30),t}function i(r){if("object"!=typeof r)return!1;var e=document.querySelectorAll("a[href^='"+window.affConnect.store_url+"']");if(!e.length)return!1;var t="";for(var f in r)t+=f+"="+r[f]+"&";t=t.slice(0,-1),e.forEach(function(e){var f=e.attributes.href.value,i=new URL(f);if(i.search){var a=n(i.search);for(var o in r)a[o]=r[o];var u="";for(var s in a)u+=s+"="+a[s]+"&";u=u.slice(0,-1),i.search="?"+u,e.attributes.href.value=i.toString()}else i.search="?"+t,e.attributes.href.value=i.toString()})}var a=n(window.location.search);if(a&&a.ref){var o=f();o&&(o.ref||o.theme_style)&&(o.url=window.location.href,o.referrer=document.referrer,function t(n){var f=new FormData;for(var a in n)f.append(a,n[a]);f.append("action","aff_connect_count_visit");var o=new XMLHttpRequest;o.open("POST",window.affConnect.ajax_url,!0),o.onload=function(){var t=JSON.parse(this.responseText);if(t.success&&t.data&&t.data.visit_id){var n=r("f_aff");n&&"object"==typeof(n=JSON.parse(n))&&(n.visit_id=t.data.visit_id,e("f_aff",JSON.stringify(n),30),i(n))}},o.send(f)}(o))}else f();var u=r("f_aff");u&&i(u=JSON.parse(u))};